---
title: "Laboratorio 3 Estadística general"
author: 'Katherine Benjumea Ortiz, Brigith Lorena Giraldo Vargas, Valentina Ochoa
  Arboleda, Tomás Atehortua Ceferino, Danilo de Jesús Toro Echeverri '
date: "2023-02-23"
output:
  html_document: default
  pdf_document: default
---
 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
 
 
## Bloque 1
 


## Bloque 2

### Problema 4

#### 1)
El valor esperado de ˆp es:

E(ˆp) = E(X/n) = (1/n) E(X) = (1/n) (n*p) = p

Por lo tanto, podemos decir que ˆp es un estimador insesgado de p.

el estimador ˆp es insesgado para p y su varianza disminuye a medida que aumenta el tamaño de la muestra (n).
```{r}
# Parámetros
n <- 50
p <- 0.6

# Generar muestra
x <- rbinom(n, n, p)

# Estimador
phat <- x/n

# Valor esperado
Ephat <- mean(phat)
Ephat # Imprime el valor esperado de phat

# Varianza
Vphat <- var(phat)
Vphat # Imprime la varianza de phat
```
#### 2)
```{r}
n <- 20
p <- seq(0, 1, 0.01)
v <- p*(1-p)/n

plot(p, v, type = "l", xlab = "p", ylab = "V(phat)", main = "Varianza del estimador phat")
which.max(v)
```

#### 3)
```{r}
n <- 20
p <- 0.5
n_sim <- 10000

# Simular 10,000 valores de X ~ Bin(20, 0.5)
x <- rbinom(n_sim, n, p)

# Calcular el estimador phat para cada valor de x
phat <- x/n

# Calcular el promedio y la varianza de los estimadores
mean_phat <- mean(phat)
var_phat <- var(phat)

# Imprimir los resultados
cat("Promedio de los estimadores:", mean_phat, "\n")
cat("Varianza de los estimadores:", var_phat)
```
### Problema 5

#### 1)
Podemos simular una muestra de tiempos de atención en R y calcular el sesgo del estimador de la media muestral X̄.

Para simular una muestra de n tiempos de atención con distribución uniforme en el intervalo (θ, θ + 1), podemos usar la función runif de la siguiente manera:

```{r}
n <- 100  # tamaño de la muestra
theta <- 5  # valor desconocido de theta
x <- runif(n, theta, theta + 1)  # simular la muestra

x_bar <- mean(x)  # calcular la media muestral
sesgo <- x_bar - theta  # calcular el sesgo

cat("Sesgo del estimador:", sesgo)
```

#### 2)
```{r}
set.seed(123) # establecemos una semilla para reproducibilidad
theta <- 25
x <- runif(10000, theta, theta+1)

# calcular la media muestral
xbar <- mean(x)

# graficar el histograma y la curva de densidad
hist(x, breaks = 30, probability = TRUE, col = "gray", main = "Histograma y curva de densidad")
curve(dunif(x, xbar, xbar+1), add = TRUE, col = "red", lwd = 2)
```


### Problema 6

#### 3)

```{r}
datos <- c(8.9, 7.5, 9.1, 8.3, 7.2, 9.5, 8.6, 9.0, 8.7, 7.8, 8.1, 9.2, 7.9, 8.5, 9.3, 7.7, 8.8, 9.4, 7.3, 8.4, 
           8.2, 7.4, 8.0, 9.6, 7.6, 8.8, 9.1, 8.7, 8.4, 7.8, 9.0, 8.2, 9.2, 7.1, 8.5, 8.9, 9.3, 7.9, 8.6, 9.4, 7.2, 
           8.3, 9.5, 7.7, 8.1, 9.6, 8.0, 8.8, 9.1)

n <- length(datos)  # Tamaño de la muestra
xbar <- mean(datos)  # Media muestral
s <- sd(datos)  # Desviación estándar muestral
alpha <- 0.05  # Nivel de significancia

# Cálculo del intervalo de confianza
t_val <- qt(1-alpha/2, df = n-1)  # Valor crítico de t
lower_ci <- xbar - t_val*s/sqrt(n)  # Límite inferior del intervalo de confianza
upper_ci <- xbar + t_val*s/sqrt(n)  # Límite superior del intervalo de confianza

# Imprimir el resultado
cat("El intervalo de confianza al 95% para µ es: (", round(lower_ci, 3), ", ", round(upper_ci, 3), ")", sep="")
```


#### 2)
```{r}
# Datos del problema
x_barra <- 8.6
s <- 2.87
n <- 50
mu <- 8
alpha <- 0.05

# Cálculo del estadístico de prueba y p-valor
t <- (x_barra - mu) / (s/sqrt(n))
p_valor <- pt(t, df = n-1, lower.tail = FALSE)

# Cálculo del valor critico de t
t_critico <- qt(alpha, df = n-1, lower.tail = FALSE)

# Resultados
cat("Valor de t =", t, "\n")
cat("Valor critico de t =", t_critico, "\n")
cat("p-valor =", p_valor, "\n")
```
No podemos rechazar la hipótesis nula

 
## Bloque 3

